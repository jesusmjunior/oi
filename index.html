<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Subregistro IBGE</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2E5BFF;
            --secondary: #6E8EFF;
            --accent: #FF6B6B;
            --light: #F5F6FA;
            --dark: #2A3F54;
            --success: #66BB6A;
            --warning: #FFA726;
            --danger: #EF5350;
            --gray: #78909C;
            --gray-light: #CFD8DC;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 24px;
            margin-top: 20px;
        }

        /* Header */
        header {
            background-color: white;
            box-shadow: var(--shadow);
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--primary);
            font-weight: 700;
            font-size: 20px;
        }

        .logo svg {
            width: 32px;
            height: 32px;
        }

        .header-actions {
            display: flex;
            gap: 16px;
        }

        /* Sidebar */
        .sidebar {
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 24px;
            height: calc(100vh - 140px);
            position: sticky;
            top: 100px;
            overflow-y: auto;
        }

        .sidebar-title {
            font-size: 16px;
            font-weight: 500;
            color: var(--gray);
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu-item {
            margin-bottom: 8px;
        }

        .sidebar-menu-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            color: var(--dark);
            text-decoration: none;
            transition: background-color 0.2s, color 0.2s;
        }

        .sidebar-menu-link:hover,
        .sidebar-menu-link.active {
            background-color: rgba(46, 91, 255, 0.1);
            color: var(--primary);
        }

        .sidebar-menu-link svg {
            width: 20px;
            height: 20px;
        }

        /* Main */
        .main {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* Cards */
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 500;
            color: var(--dark);
        }

        .card-actions {
            display: flex;
            gap: 12px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 24px;
        }

        .stat-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 24px;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-title {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 12px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .stat-trend.up {
            color: var(--success);
        }

        .stat-trend.down {
            color: var(--danger);
        }

        /* Forms */
        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-text {
            font-size: 12px;
            color: var(--gray);
            margin-top: 4px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn svg {
            width: 18px;
            height: 18px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #1A48E6;
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--gray-light);
            color: var(--dark);
        }

        .btn-outline:hover {
            background-color: var(--light);
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #43A047;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: #E53935;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-top: 16px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--gray-light);
        }

        th {
            font-weight: 500;
            color: var(--gray);
            font-size: 14px;
        }

        td {
            font-size: 14px;
        }

        tbody tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 16px;
        }

        .map-container {
            height: 500px;
            margin-top: 16px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 24px;
        }

        .tab {
            padding: 12px 24px;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            color: var(--gray);
            transition: all 0.3s;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Upload */
        .upload-area {
            border: 2px dashed var(--gray-light);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin-bottom: 24px;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .upload-area:hover {
            border-color: var(--primary);
        }

        .upload-icon {
            display: block;
            margin: 0 auto 16px;
            color: var(--primary);
            width: 48px;
            height: 48px;
        }

        .upload-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .upload-text {
            font-size: 14px;
            color: var(--gray);
        }

        /* Alerts */
        .alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .alert-success {
            background-color: rgba(102, 187, 106, 0.1);
            border-left: 4px solid var(--success);
            color: #2E7D32;
        }

        .alert-warning {
            background-color: rgba(255, 167, 38, 0.1);
            border-left: 4px solid var(--warning);
            color: #EF6C00;
        }

        .alert-danger {
            background-color: rgba(239, 83, 80, 0.1);
            border-left: 4px solid var(--danger);
            color: #C62828;
        }

        /* Progress */
        .progress {
            height: 8px;
            background-color: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary);
            border-radius: 4px;
            width: 0;
            transition: width 0.5s;
        }

        /* Utilities */
        .mt-4 {
            margin-top: 16px;
        }

        .mb-4 {
            margin-bottom: 16px;
        }

        .hidden {
            display: none;
        }

        .flex {
            display: flex;
        }

        .flex-center {
            justify-content: center;
            align-items: center;
        }

        .flex-between {
            justify-content: space-between;
            align-items: center;
        }

        .flex-column {
            flex-direction: column;
        }

        .gap-2 {
            gap: 8px;
        }

        .gap-4 {
            gap: 16px;
        }

        .text-center {
            text-align: center;
        }

        .text-success {
            color: var(--success);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-danger {
            color: var(--danger);
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 24px;
        }

        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid var(--gray-light);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .grid {
                grid-template-columns: 1fr;
            }

            .sidebar {
                height: auto;
                position: static;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .header-container {
                flex-direction: column;
                gap: 16px;
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            pointer-events: none;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--dark) transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* File list */
        .file-list {
            margin-top: 16px;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background-color: var(--light);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .file-icon {
            color: var(--primary);
        }

        .file-name {
            font-size: 14px;
            font-weight: 500;
        }

        .file-size {
            font-size: 12px;
            color: var(--gray);
        }

        .file-actions {
            display: flex;
            gap: 8px;
        }

        .file-action {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--gray);
            transition: color 0.2s;
        }

        .file-action:hover {
            color: var(--primary);
        }

        .file-action.delete:hover {
            color: var(--danger);
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                    <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                    <line x1="12" y1="22.08" x2="12" y2="12"></line>
                </svg>
                <span>Dashboard de Subregistro IBGE</span>
            </div>
            <div class="header-actions">
                <button id="btn-refresh" class="btn btn-outline">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 2v6h-6"></path>
                        <path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path>
                        <path d="M3 22v-6h6"></path>
                        <path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path>
                    </svg>
                    Atualizar Dados
                </button>
                <button id="btn-export" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Exportar
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="grid">
            <aside class="sidebar">
                <h3 class="sidebar-title">Menu</h3>
                <ul class="sidebar-menu">
                    <li class="sidebar-menu-item">
                        <a href="#dashboard" class="sidebar-menu-link active" data-tab="dashboard">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                            Dashboard
                        </a>
                    </li>
                    <li class="sidebar-menu-item">
                        <a href="#upload" class="sidebar-menu-link" data-tab="upload">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            Importar Dados
                        </a>
                    </li>
                    <li class="sidebar-menu-item">
                        <a href="#nacional" class="sidebar-menu-link" data-tab="nacional">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                <polyline points="9 22 9 12 15 12 15 22"></polyline>
                            </svg>
                            Dados Nacionais
                        </a>
                    </li>
                    <li class="sidebar-menu-item">
                        <a href="#regional" class="sidebar-menu-link" data-tab="regional">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path>
                                <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
                            </svg>
                            Dados Regionais (NE)
                        </a>
                    </li>
                    <li class="sidebar-menu-item">
                        <a href="#municipios" class="sidebar-menu-link" data-tab="municipios">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
                            </svg>
                            Municípios
                        </a>
                    </li>
                    <li class="sidebar-menu-item">
                        <a href="#mapa" class="sidebar-menu-link" data-tab="mapa">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon>
                                <line x1="8" y1="2" x2="8" y2="18"></line>
                                <line x1="16" y1="6" x2="16" y2="22"></line>
                            </svg>
                            Mapa de Subregistro
                        </a>
                    </li>
                    <li class="sidebar-menu-item">
                        <a href="#comparativo" class="sidebar-menu-link" data-tab="comparativo">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="18" y1="20" x2="18" y2="10"></line>
                                <line x1="12" y1="20" x2="12" y2="4"></line>
                                <line x1="6" y1="20" x2="6" y2="14"></line>
                            </svg>
                            Comparativo
                        </a>
                    </li>
                    <li class="sidebar-menu-item">
                        <a href="#tabelas" class="sidebar-menu-link" data-tab="tabelas">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 3h18v18H3zM3 9h18M3 15h18M9 3v18M15 3v18"></path>
                            </svg>
                            Tabelas de Dados
                        </a>
                    </li>
                </ul>
            </aside>

            <main class="main">
                <!-- Dashboard -->
                <div id="dashboard" class="tab-content active">
                    <div class="alert alert-warning" id="no-data-alert">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <div>
                            <p><strong>Nenhum dado carregado.</strong> Por favor, importe arquivos de dados do IBGE para visualizar as estatísticas de subregistro.</p>
                            <button class="btn btn-primary mt-4" id="goto-upload">Importar Dados</button>
                        </div>
                    </div>

                    <div id="dashboard-content" class="hidden">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-title">Taxa de Subregistro Nacional</div>
                                <div class="stat-value" id="taxa-nacional">--</div>
                                <div class="stat-trend" id="trend-nacional">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    <span>--% em relação ao período anterior</span>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">Taxa de Subregistro Nordeste</div>
                                <div class="stat-value" id="taxa-nordeste">--</div>
                                <div class="stat-trend" id="trend-nordeste">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                    <span>--% em relação ao período anterior</span>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">Total de Nascimentos</div>
                                <div class="stat-value" id="total-nascimentos">--</div>
                                <div class="stat-trend" id="trend-nascimentos">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="18 15 12 9 6 15"></polyline>
                                    </svg>
                                    <span>--% em relação ao período anterior</span>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-title">Total de Municípios Analisados</div>
                                <div class="stat-value" id="total-municipios">--</div>
                                <div class="stat-trend up">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12 16 12 12 16 12"></polyline>
                                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                                    </svg>
                                    <span>Dados atualizados</span>
                                </div>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Evolução da Taxa de Subregistro</h2>
                                <div class="card-actions">
                                    <div class="tooltip">
                                        <button class="btn btn-outline">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <circle cx="12" cy="12" r="10"></circle>
                                                <line x1="12" y1="16" x2="12" y2="12"></line>
                                                <line x1="12" y1="8" x2="12.01" y2="8"></line>
                                            </svg>
                                        </button>
                                        <span class="tooltiptext">Este gráfico mostra a evolução da taxa de subregistro ao longo do tempo</span>
                                    </div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="chart-evolucao"></canvas>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Resumo de Subregistro por UF</h2>
                                <div class="card-actions">
                                    <select id="select-year" class="form-control">
                                        <option value="latest">Último período disponível</option>
                                    </select>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="chart-uf"></canvas>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Top 10 Municípios com Maior Subregistro</h2>
                            </div>
                            <div class="table-container">
                                <table id="table-top-municipios">
                                    <thead>
                                        <tr>
                                            <th>Município</th>
                                            <th>UF</th>
                                            <th>Taxa de Subregistro</th>
                                            <th>Total de Nascimentos</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="4" class="text-center">Carregando dados...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Upload -->
                <div id="upload" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Importar Dados do IBGE</h2>
                        </div>
                        <div class="card-content">
                            <p class="mb-4">Para visualizar os dados de subregistro, importe os arquivos Excel fornecidos pelo IBGE.</p>
                            
                            <div class="form-group">
                                <label class="form-label">Arquivo de Dados Brasil/Nordeste</label>
                                <div class="upload-area" id="upload-br-ne">
                                    <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                    <h3 class="upload-title">Arraste e solte ou clique para importar</h3>
                                    <p class="upload-text">Arquivo IBGE_Subregistro_Posicao_BR_NE.xls</p>
                                    <input type="file" id="file-br-ne" accept=".xls,.xlsx" class="hidden">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Arquivo de Dados Municipais</label>
                                <div class="upload-area" id="upload-municipios">
                                    <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                    <h3 class="upload-title">Arraste e solte ou clique para importar</h3>
                                    <p class="upload-text">Arquivo IBGE_Subregistro_Posicao_Municipios.xls</p>
                                    <input type="file" id="file-municipios" accept=".xls,.xlsx" class="hidden">
                                </div>
                            </div>

                            <div id="file-list" class="file-list hidden">
                                <h3 class="mb-4">Arquivos Importados</h3>
                                <div id="files-container"></div>
                            </div>

                            <div id="import-progress" class="hidden">
                                <h3 class="mb-4">Processando Arquivos</h3>
                                <div class="progress mb-4">
                                    <div class="progress-bar" id="progress-bar"></div>
                                </div>
                                <p id="progress-text">Aguarde enquanto processamos seus arquivos...</p>
                            </div>

                            <div id="import-success" class="alert alert-success hidden">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                    <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                </svg>
                                <div>
                                    <p><strong>Importação concluída com sucesso!</strong> Os dados foram processados e estão prontos para visualização.</p>
                                    <button class="btn btn-primary mt-4" id="goto-dashboard">Ver Dashboard</button>
                                </div>
                            </div>

                            <div id="import-error" class="alert alert-danger hidden">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="15" y1="9" x2="9" y2="15"></line>
                                    <line x1="9" y1="9" x2="15" y2="15"></line>
                                </svg>
                                <div>
                                    <p><strong>Erro na importação!</strong> <span id="error-message">Ocorreu um erro ao processar os arquivos.</span></p>
                                    <button class="btn btn-primary mt-4" id="retry-import">Tentar Novamente</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Nacional -->
                <div id="nacional" class="tab-content">
                    <div class="alert alert-warning" id="no-data-nacional">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <div>
                            <p><strong>Nenhum dado nacional carregado.</strong> Por favor, importe o arquivo IBGE_Subregistro_Posicao_BR_NE.xls para visualizar estas estatísticas.</p>
                            <button class="btn btn-primary mt-4 goto-upload">Importar Dados</button>
                        </div>
                    </div>

                    <div id="nacional-content" class="hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Evolução da Taxa de Subregistro no Brasil</h2>
                            </div>
                            <div class="chart-container">
                                <canvas id="chart-nacional"></canvas>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Dados Históricos - Brasil</h2>
                            </div>
                            <div class="table-container">
                                <table id="table-nacional">
                                    <thead>
                                        <tr>
                                            <th>Ano</th>
                                            <th>Nascidos Vivos</th>
                                            <th>Registrados</th>
                                            <th>Não Registrados</th>
                                            <th>Taxa de Subregistro (%)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="text-center">Carregando dados...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Análise Comparativa</h2>
                            </div>
                            <div class="chart-container">
                                <canvas id="chart-comparativo-nacional"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Regional -->
                <div id="regional" class="tab-content">
                    <div class="alert alert-warning" id="no-data-regional">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <div>
                            <p><strong>Nenhum dado regional carregado.</strong> Por favor, importe o arquivo IBGE_Subregistro_Posicao_BR_NE.xls para visualizar estas estatísticas.</p>
                            <button class="btn btn-primary mt-4 goto-upload">Importar Dados</button>
                        </div>
                    </div>

                    <div id="regional-content" class="hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Evolução da Taxa de Subregistro no Nordeste</h2>
                            </div>
                            <div class="chart-container">
                                <canvas id="chart-nordeste"></canvas>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Comparativo por Estado (Nordeste)</h2>
                                <div class="card-actions">
                                    <select id="select-year-ne" class="form-control">
                                        <option value="latest">Último período disponível</option>
                                    </select>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="chart-estados-ne"></canvas>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Dados Históricos - Nordeste</h2>
                            </div>
                            <div class="table-container">
                                <table id="table-nordeste">
                                    <thead>
                                        <tr>
                                            <th>Ano</th>
                                            <th>Nascidos Vivos</th>
                                            <th>Registrados</th>
                                            <th>Não Registrados</th>
                                            <th>Taxa de Subregistro (%)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="text-center">Carregando dados...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Municípios -->
                <div id="municipios" class="tab-content">
                    <div class="alert alert-warning" id="no-data-municipios">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <div>
                            <p><strong>Nenhum dado municipal carregado.</strong> Por favor, importe o arquivo IBGE_Subregistro_Posicao_Municipios.xls para visualizar estas estatísticas.</p>
                            <button class="btn btn-primary mt-4 goto-upload">Importar Dados</button>
                        </div>
                    </div>

                    <div id="municipios-content" class="hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Pesquisar Município</h2>
                            </div>
                            <div class="card-content">
                                <div class="form-group">
                                    <label class="form-label">Filtrar por município</label>
                                    <div class="flex gap-4">
                                        <input type="text" id="search-municipio" class="form-control" placeholder="Digite o nome do município">
                                        <button id="btn-search" class="btn btn-primary">Pesquisar</button>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Filtrar por UF</label>
                                    <select id="select-uf" class="form-control">
                                        <option value="">Todos os estados</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Ranking de Municípios por Subregistro</h2>
                                <div class="card-actions">
                                    <select id="select-order" class="form-control">
                                        <option value="desc">Maior para menor</option>
                                        <option value="asc">Menor para maior</option>
                                    </select>
                                </div>
                            </div>
                            <div class="table-container">
                                <table id="table-municipios">
                                    <thead>
                                        <tr>
                                            <th>Município</th>
                                            <th>UF</th>
                                            <th>Taxa de Subregistro (%)</th>
                                            <th>Nascidos Vivos</th>
                                            <th>Registrados</th>
                                            <th>Não Registrados</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" class="text-center">Carregando dados...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="card mt-4 hidden" id="municipio-detalhes">
                            <div class="card-header">
                                <h2 class="card-title">Detalhes do Município: <span id="municipio-nome"></span></h2>
                            </div>
                            <div class="card-content">
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <div class="stat-title">Taxa de Subregistro</div>
                                        <div class="stat-value" id="municipio-taxa">--</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-title">Nascidos Vivos</div>
                                        <div class="stat-value" id="municipio-nascidos">--</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-title">Registrados</div>
                                        <div class="stat-value" id="municipio-registrados">--</div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-title">Não Registrados</div>
                                        <div class="stat-value" id="municipio-nao-registrados">--</div>
                                    </div>
                                </div>
                                
                                <div class="chart-container mt-4">
                                    <canvas id="chart-municipio"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mapa -->
                <div id="mapa" class="tab-content">
                    <div class="alert alert-warning" id="no-data-mapa">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <div>
                            <p><strong>Nenhum dado carregado.</strong> Por favor, importe os arquivos de dados para visualizar o mapa de subregistro.</p>
                            <button class="btn btn-primary mt-4 goto-upload">Importar Dados</button>
                        </div>
                    </div>

                    <div id="mapa-content" class="hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Mapa de Subregistro por UF</h2>
                                <div class="card-actions">
                                    <select id="select-view" class="form-control">
                                        <option value="br">Brasil</option>
                                        <option value="ne">Nordeste</option>
                                    </select>
                                </div>
                            </div>
                            <div class="map-container">
                                <div id="map-container" style="width: 100%; height: 100%;"></div>
                            </div>
                        </div>

                        <div class="card mt-4">
                            <div class="card-header">
                                <h2 class="card-title">Legenda</h2>
                            </div>
                            <div class="card-content">
                                <div class="flex flex-between">
                                    <div>
                                        <div class="flex gap-2 mb-4">
                                            <div style="width: 20px; height: 20px; background-color: #f8d7da; border-radius: 4px;"></div>
                                            <span>Acima de 20% (Crítico)</span>
                                        </div>
                                        <div class="flex gap-2 mb-4">
                                            <div style="width: 20px; height: 20px; background-color: #fff3cd; border-radius: 4px;"></div>
                                            <span>Entre 10% e 20% (Alerta)</span>
                                        </div>
                                        <div class="flex gap-2 mb-4">
                                            <div style="width: 20px; height: 20px; background-color: #d1e7dd; border-radius: 4px;"></div>
                                            <span>Entre 5% e 10% (Moderado)</span>
                                        </div>
                                        <div class="flex gap-2">
                                            <div style="width: 20px; height: 20px; background-color: #c3e6cb; border-radius: 4px;"></div>
                                            <span>Abaixo de 5% (Adequado)</span>
                                        </div>
                                    </div>
                                    <div>
                                        <p>Os dados apresentados são baseados nas taxas de subregistro calculadas pelo IBGE.</p>
                                        <p>Clique em um estado para ver mais detalhes.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Comparativo -->
                <div id="comparativo" class="tab-content">
                    <div class="alert alert-warning" id="no-data-comparativo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <div>
                            <p><strong>Nenhum dado carregado.</strong> Por favor, importe os arquivos de dados para acessar as análises comparativas.</p>
                            <button class="btn btn-primary mt-4 goto-upload">Importar Dados</button>
                        </div>
                    </div>

                    <div id="comparativo-content" class="hidden">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Análise Comparativa</h2>
                            </div>
                            <div class="card-content">
                                <div class="form-group">
                                    <label class="form-label">Selecione os itens para comparação</label>
                                    <div class="flex gap-4">
                                        <select id="select-item1" class="form-control">
                                            <option value="br">Brasil</option>
                                            <option value="ne">Nordeste</option>
                                            <option value="uf">UF específica</option>
                                            <option value="municipio">Município</option>
                                        </select>
                                        <select id="select-uf1" class="form-control hidden">
                                            <option value="">Selecione a UF</option>
                                        </select>
                                        <select id="select-municipio1" class="form-control hidden">
                                            <option value="">Selecione o município</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="flex gap-4">
                                        <select id="select-item2" class="form-control">
                                            <option value="ne">Nordeste</option>
                                            <option value="br">Brasil</option>
                                            <option value="uf">UF específica</option>
                                            <option value="municipio">Município</option>
                                        </select>
                                        <select id="select-uf2" class="form-control hidden">
                                            <option value="">Selecione a UF</option>
                                        </select>
                                        <select id="select-municipio2" class="form-control hidden">
                                            <option value="">Selecione o município</option>
                                        </select>
                                    </div>
                                </div>

                                <button id="btn-comparar" class="btn btn-primary mt-4">Comparar</button>
                            </div>
                        </div>

                        <div class="card mt-4 hidden" id="resultado-comparativo">
                            <div class="card-header">
                                <h2 class="card-title">Resultado Comparativo</h2>
                            </div>
                            <div class="card-content">
                                <div class="chart-container">
                                    <canvas id="chart-comparativo"></canvas>
                                </div>

                                <div class="table-container mt-4">
                                    <table id="table-comparativo">
                                        <thead>
                                            <tr>
                                                <th>Item</th>
                                                <th>Taxa de Subregistro (%)</th>
                                                <th>Nascidos Vivos</th>
                                                <th>Registrados</th>
                                                <th>Não Registrados</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td id="comp-nome1">Item 1</td>
                                                <td id="comp-taxa1">--</td>
                                                <td id="comp-nascidos1">--</td>
                                                <td id="comp-registrados1">--</td>
                                                <td id="comp-nao-registrados1">--</td>
                                            </tr>
                                            <tr>
                                                <td id="comp-nome2">Item 2</td>
                                                <td id="comp-taxa2">--</td>
                                                <td id="comp-nascidos2">--</td>
                                                <td id="comp-registrados2">--</td>
                                                <td id="comp-nao-registrados2">--</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Diferença</strong></td>
                                                <td id="comp-taxa-diff">--</td>
                                                <td id="comp-nascidos-diff">--</td>
                                                <td id="comp-registrados-diff">--</td>
                                                <td id="comp-nao-registrados-diff">--</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabelas -->
                <div id="tabelas" class="tab-content">
                    <div class="alert alert-warning" id="no-data-tabelas">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="12"></line>
                            <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <div>
                            <p><strong>Nenhum dado carregado.</strong> Por favor, importe os arquivos de dados para visualizar as tabelas completas.</p>
                            <button class="btn btn-primary mt-4 goto-upload">Importar Dados</button>
                        </div>
                    </div>

                    <div id="tabelas-content" class="hidden">
                        <div class="tabs">
                            <div class="tab active" data-tab-content="tab-nacional">Brasil</div>
                            <div class="tab" data-tab-content="tab-nordeste">Nordeste</div>
                            <div class="tab" data-tab-content="tab-estados">Estados</div>
                            <div class="tab" data-tab-content="tab-municipios">Municípios</div>
                        </div>

                        <div id="tab-nacional" class="tab-content active">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Dados Nacionais Completos</h2>
                                    <div class="card-actions">
                                        <button id="export-nacional" class="btn btn-outline">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                <polyline points="7 10 12 15 17 10"></polyline>
                                                <line x1="12" y1="15" x2="12" y2="3"></line>
                                            </svg>
                                            Exportar
                                        </button>
                                    </div>
                                </div>
                                <div class="table-container">
                                    <table id="table-completo-nacional">
                                        <thead>
                                            <tr>
                                                <th>Ano</th>
                                                <th>Nascidos Vivos</th>
                                                <th>Registrados</th>
                                                <th>Não Registrados</th>
                                                <th>Taxa de Subregistro (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="5" class="text-center">Carregando dados...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div id="tab-nordeste" class="tab-content">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Dados do Nordeste Completos</h2>
                                    <div class="card-actions">
                                        <button id="export-nordeste" class="btn btn-outline">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                <polyline points="7 10 12 15 17 10"></polyline>
                                                <line x1="12" y1="15" x2="12" y2="3"></line>
                                            </svg>
                                            Exportar
                                        </button>
                                    </div>
                                </div>
                                <div class="table-container">
                                    <table id="table-completo-nordeste">
                                        <thead>
                                            <tr>
                                                <th>Ano</th>
                                                <th>Nascidos Vivos</th>
                                                <th>Registrados</th>
                                                <th>Não Registrados</th>
                                                <th>Taxa de Subregistro (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="5" class="text-center">Carregando dados...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div id="tab-estados" class="tab-content">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Dados por Estado</h2>
                                    <div class="card-actions">
                                        <button id="export-estados" class="btn btn-outline">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                <polyline points="7 10 12 15 17 10"></polyline>
                                                <line x1="12" y1="15" x2="12" y2="3"></line>
                                            </svg>
                                            Exportar
                                        </button>
                                    </div>
                                </div>
                                <div class="table-container">
                                    <table id="table-completo-estados">
                                        <thead>
                                            <tr>
                                                <th>UF</th>
                                                <th>Nascidos Vivos</th>
                                                <th>Registrados</th>
                                                <th>Não Registrados</th>
                                                <th>Taxa de Subregistro (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="5" class="text-center">Carregando dados...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div id="tab-municipios" class="tab-content">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Dados Municipais Completos</h2>
                                    <div class="card-actions">
                                        <div class="flex gap-4">
                                            <select id="filter-uf" class="form-control">
                                                <option value="">Todos os estados</option>
                                            </select>
                                            <button id="export-municipios" class="btn btn-outline">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                                    <polyline points="7 10 12 15 17 10"></polyline>
                                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                                </svg>
                                                Exportar
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-container">
                                    <table id="table-completo-municipios">
                                        <thead>
                                            <tr>
                                                <th>Município</th>
                                                <th>UF</th>
                                                <th>Nascidos Vivos</th>
                                                <th>Registrados</th>
                                                <th>Não Registrados</th>
                                                <th>Taxa de Subregistro (%)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="6" class="text-center">Carregando dados...</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        // Estado global da aplicação
        const appState = {
            dadosBrNe: null,
            dadosMunicipios: null,
            chartsInstances: {},
            ufList: [
                { sigla: 'AC', nome: 'Acre' },
                { sigla: 'AL', nome: 'Alagoas' },
                { sigla: 'AM', nome: 'Amazonas' },
                { sigla: 'AP', nome: 'Amapá' },
                { sigla: 'BA', nome: 'Bahia' },
                { sigla: 'CE', nome: 'Ceará' },
                { sigla: 'DF', nome: 'Distrito Federal' },
                { sigla: 'ES', nome: 'Espírito Santo' },
                { sigla: 'GO', nome: 'Goiás' },
                { sigla: 'MA', nome: 'Maranhão' },
                { sigla: 'MG', nome: 'Minas Gerais' },
                { sigla: 'MS', nome: 'Mato Grosso do Sul' },
                { sigla: 'MT', nome: 'Mato Grosso' },
                { sigla: 'PA', nome: 'Pará' },
                { sigla: 'PB', nome: 'Paraíba' },
                { sigla: 'PE', nome: 'Pernambuco' },
                { sigla: 'PI', nome: 'Piauí' },
                { sigla: 'PR', nome: 'Paraná' },
                { sigla: 'RJ', nome: 'Rio de Janeiro' },
                { sigla: 'RN', nome: 'Rio Grande do Norte' },
                { sigla: 'RO', nome: 'Rondônia' },
                { sigla: 'RR', nome: 'Roraima' },
                { sigla: 'RS', nome: 'Rio Grande do Sul' },
                { sigla: 'SC', nome: 'Santa Catarina' },
                { sigla: 'SE', nome: 'Sergipe' },
                { sigla: 'SP', nome: 'São Paulo' },
                { sigla: 'TO', nome: 'Tocantins' }
            ],
            ufNordeste: ['MA', 'PI', 'CE', 'RN', 'PB', 'PE', 'AL', 'SE', 'BA']
        };

        // Inicialização da aplicação
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar navegação por tabs
            initTabs();
            
            // Inicializar handlers de upload
            initUploadHandlers();
            
            // Inicializar eventos de UI
            initUIEvents();
            
            // Verificar se já existem dados salvos em localStorage
            checkForSavedData();
        });

        // Inicializar navegação por tabs
        function initTabs() {
            const tabLinks = document.querySelectorAll('.sidebar-menu-link');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    // Remover classe active de todos os links
                    tabLinks.forEach(l => l.classList.remove('active'));
                    
                    // Adicionar classe active ao link clicado
                    link.classList.add('active');
                    
                    // Esconder todos os conteúdos de tab
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Mostrar o conteúdo correspondente
                    const targetId = link.getAttribute('data-tab');
                    document.getElementById(targetId).classList.add('active');
                });
            });

            // Inicializar tabs dentro das seções
            const innerTabs = document.querySelectorAll('.tabs .tab');
            innerTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const parent = tab.parentElement;
                    const tabs = parent.querySelectorAll('.tab');
                    const targetId = tab.getAttribute('data-tab-content');
                    
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    const contents = document.querySelectorAll('.tab-content');
                    contents.forEach(c => c.classList.remove('active'));
                    document.getElementById(targetId).classList.add('active');
                });
            });
        }

        // Inicializar handlers de upload
        function initUploadHandlers() {
            const uploadAreaBrNe = document.getElementById('upload-br-ne');
            const fileBrNe = document.getElementById('file-br-ne');
            const uploadAreaMunicipios = document.getElementById('upload-municipios');
            const fileMunicipios = document.getElementById('file-municipios');
            
            // Upload do arquivo BR/NE
            uploadAreaBrNe.addEventListener('click', () => {
                fileBrNe.click();
            });
            
            uploadAreaBrNe.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadAreaBrNe.style.borderColor = 'var(--primary)';
            });
            
            uploadAreaBrNe.addEventListener('dragleave', () => {
                uploadAreaBrNe.style.borderColor = 'var(--gray-light)';
            });
            
            uploadAreaBrNe.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadAreaBrNe.style.borderColor = 'var(--gray-light)';
                
                if (e.dataTransfer.files.length) {
                    fileBrNe.files = e.dataTransfer.files;
                    handleFileBrNe(e.dataTransfer.files[0]);
                }
            });
            
            fileBrNe.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    handleFileBrNe(e.target.files[0]);
                }
            });
            
            // Upload do arquivo Municípios
            uploadAreaMunicipios.addEventListener('click', () => {
                fileMunicipios.click();
            });
            
            uploadAreaMunicipios.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadAreaMunicipios.style.borderColor = 'var(--primary)';
            });
            
            uploadAreaMunicipios.addEventListener('dragleave', () => {
                uploadAreaMunicipios.style.borderColor = 'var(--gray-light)';
            });
            
            uploadAreaMunicipios.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadAreaMunicipios.style.borderColor = 'var(--gray-light)';
                
                if (e.dataTransfer.files.length) {
                    fileMunicipios.files = e.dataTransfer.files;
                    handleFileMunicipios(e.dataTransfer.files[0]);
                }
            });
            
            fileMunicipios.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    handleFileMunicipios(e.target.files[0]);
                }
            });
        }

        // Processar arquivo BR/NE
        function handleFileBrNe(file) {
            // Verificar tipo de arquivo
            if (!file.name.endsWith('.xls') && !file.name.endsWith('.xlsx')) {
                showError('O arquivo deve ser um arquivo Excel (.xls ou .xlsx)');
                return;
            }
            
            showProgress();
            
            // Ler o arquivo usando SheetJS
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Processar dados do Brasil e Nordeste
                    const dadosBrNe = processarDadosBrNe(workbook);
                    appState.dadosBrNe = dadosBrNe;
                    
                    // Salvar dados no localStorage
                    localStorage.setItem('dadosBrNe', JSON.stringify(dadosBrNe));
                    
                    // Atualizar interface
                    updateFileList();
                    checkDataReady();
                    updateProgressBar(50);
                } catch (error) {
                    console.error('Erro ao processar arquivo BR/NE:', error);
                    showError('Erro ao processar o arquivo. Verifique se é um arquivo Excel válido.');
                    hideProgress();
                }
            };
            
            reader.onerror = () => {
                showError('Erro ao ler o arquivo. Tente novamente.');
                hideProgress();
            };
            
            reader.readAsArrayBuffer(file);
        }

        // Processar arquivo Municípios
        function handleFileMunicipios(file) {
            // Verificar tipo de arquivo
            if (!file.name.endsWith('.xls') && !file.name.endsWith('.xlsx')) {
                showError('O arquivo deve ser um arquivo Excel (.xls ou .xlsx)');
                return;
            }
            
            showProgress();
            
            // Ler o arquivo usando SheetJS
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Processar dados municipais
                    const dadosMunicipios = processarDadosMunicipios(workbook);
                    appState.dadosMunicipios = dadosMunicipios;
                    
                    // Salvar dados no localStorage
                    localStorage.setItem('dadosMunicipios', JSON.stringify(dadosMunicipios));
                    
                    // Atualizar interface
                    updateFileList();
                    checkDataReady();
                    updateProgressBar(75);
                } catch (error) {
                    console.error('Erro ao processar arquivo Municípios:', error);
                    showError('Erro ao processar o arquivo. Verifique se é um arquivo Excel válido.');
                    hideProgress();
                }
            };
            
            reader.onerror = () => {
                showError('Erro ao ler o arquivo. Tente novamente.');
                hideProgress();
            };
            
            reader.readAsArrayBuffer(file);
        }

        // Processar dados do arquivo BR/NE
        function processarDadosBrNe(workbook) {
            // Implementação simulada - ajuste conforme a estrutura real dos arquivos
            const dadosBrasil = [];
            const dadosNordeste = [];
            
            // Verificar se há uma planilha "Brasil" ou semelhante
            const sheetNames = workbook.SheetNames;
            
            // Supondo que a primeira planilha contém dados do Brasil
            if (sheetNames.length > 0) {
                const brasilSheet = workbook.Sheets[sheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(brasilSheet, { header: 1 });
                
                // Processar dados (exemplo simplificado - ajuste conforme estrutura real)
                // Pular cabeçalho
                for (let i = 1; i < jsonData.length; i++) {
                    const row = jsonData[i];
                    if (row && row.length >= 5) {
                        dadosBrasil.push({
                            ano: row[0],
                            nascidosVivos: parseInt(row[1]) || 0,
                            registrados: parseInt(row[2]) || 0,
                            naoRegistrados: parseInt(row[3]) || 0,
                            taxaSubregistro: parseFloat(row[4]) || 0
                        });
                    }
                }
            }
            
            // Supondo que a segunda planilha contém dados do Nordeste
            if (sheetNames.length > 1) {
                const neSheet = workbook.Sheets[sheetNames[1]];
                const jsonData = XLSX.utils.sheet_to_json(neSheet, { header: 1 });
                
                // Processar dados (exemplo simplificado - ajuste conforme estrutura real)
                // Pular cabeçalho
                for (let i = 1; i < jsonData.length; i++) {
                    const row = jsonData[i];
                    if (row && row.length >= 5) {
                        dadosNordeste.push({
                            ano: row[0],
                            nascidosVivos: parseInt(row[1]) || 0,
                            registrados: parseInt(row[2]) || 0,
                            naoRegistrados: parseInt(row[3]) || 0,
                            taxaSubregistro: parseFloat(row[4]) || 0
                        });
                    }
                }
            }
            
            return { brasil: dadosBrasil, nordeste: dadosNordeste };
        }

        // Processar dados do arquivo Municípios
        function processarDadosMunicipios(workbook) {
            // Implementação simulada - ajuste conforme a estrutura real dos arquivos
            const dadosMunicipios = [];
            
            // Verificar se há uma planilha "Municípios" ou semelhante
            const sheetNames = workbook.SheetNames;
            
            if (sheetNames.length > 0) {
                const municipiosSheet = workbook.Sheets[sheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(municipiosSheet, { header: 1 });
                
                // Processar dados (exemplo simplificado - ajuste conforme estrutura real)
                // Pular cabeçalho
                for (let i = 1; i < jsonData.length; i++) {
                    const row = jsonData[i];
                    if (row && row.length >= 6) {
                        dadosMunicipios.push({
                            municipio: row[0],
                            uf: row[1],
                            nascidosVivos: parseInt(row[2]) || 0,
                            registrados: parseInt(row[3]) || 0,
                            naoRegistrados: parseInt(row[4]) || 0,
                            taxaSubregistro: parseFloat(row[5]) || 0
                        });
                    }
                }
            }
            
            return dadosMunicipios;
        }

        // Atualizar lista de arquivos importados
        function updateFileList() {
            const fileList = document.getElementById('file-list');
            const filesContainer = document.getElementById('files-container');
            
            // Limpar conteúdo atual
            filesContainer.innerHTML = '';
            
            // Verificar se há arquivos importados
            const hasBrNe = Boolean(appState.dadosBrNe);
            const hasMunicipios = Boolean(appState.dadosMunicipios);
            
            if (hasBrNe || hasMunicipios) {
                fileList.classList.remove('hidden');
                
                if (hasBrNe) {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            <div>
                                <div class="file-name">IBGE_Subregistro_Posicao_BR_NE.xls</div>
                                <div class="file-size">Dados importados com sucesso</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button class="file-action delete" data-file="br-ne">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                    <line x1="10" y1="11" x2="10" y2="17"></line>
                                    <line x1="14" y1="11" x2="14" y2="17"></line>
                                </svg>
                            </button>
                        </div>
                    `;
                    filesContainer.appendChild(fileItem);
                }
                
                if (hasMunicipios) {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <svg class="file-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10 9 9 9 8 9"></polyline>
                            </svg>
                            <div>
                                <div class="file-name">IBGE_Subregistro_Posicao_Municipios.xls</div>
                                <div class="file-size">Dados importados com sucesso</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button class="file-action delete" data-file="municipios">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                    <line x1="10" y1="11" x2="10" y2="17"></line>
                                    <line x1="14" y1="11" x2="14" y2="17"></line>
                                </svg>
                            </button>
                        </div>
                    `;
                    filesContainer.appendChild(fileItem);
                }
                
                // Adicionar event listeners para botões de exclusão
                const deleteButtons = document.querySelectorAll('.file-action.delete');
                deleteButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const fileType = button.getAttribute('data-file');
                        if (fileType === 'br-ne') {
                            appState.dadosBrNe = null;
                            localStorage.removeItem('dadosBrNe');
                        } else if (fileType === 'municipios') {
                            appState.dadosMunicipios = null;
                            localStorage.removeItem('dadosMunicipios');
                        }
                        
                        updateFileList();
                        checkDataReady();
                    });
                });
            } else {
                fileList.classList.add('hidden');
            }
        }

        // Verificar se os dados estão prontos para visualização
        function checkDataReady() {
            const hasBrNe = Boolean(appState.dadosBrNe);
            const hasMunicipios = Boolean(appState.dadosMunicipios);
            
            if (hasBrNe && hasMunicipios) {
                // Ambos os arquivos foram importados
                hideProgress();
                showSuccess();
                updateDashboard();
            } else if (hasBrNe || hasMunicipios) {
                // Apenas um arquivo foi importado
                hideProgress();
                updateProgressBar(100);
                
                // Atualizar visibilidade das seções correspondentes
                if (hasBrNe) {
                    document.getElementById('no-data-nacional').classList.add('hidden');
                    document.getElementById('nacional-content').classList.remove('hidden');
                    document.getElementById('no-data-regional').classList.add('hidden');
                    document.getElementById('regional-content').classList.remove('hidden');
                    updateNacionalDashboard();
                    updateRegionalDashboard();
                }
                
                if (hasMunicipios) {
                    document.getElementById('no-data-municipios').classList.add('hidden');
                    document.getElementById('municipios-content').classList.remove('hidden');
                    updateMunicipiosDashboard();
                }
                
                // Mostra alerta no dashboard principal
                document.getElementById('no-data-alert').classList.remove('hidden');
                document.getElementById('dashboard-content').classList.add('hidden');
                
                // Mostra alerta no mapa e comparativo
                document.getElementById('no-data-mapa').classList.remove('hidden');
                document.getElementById('mapa-content').classList.add('hidden');
                document.getElementById('no-data-comparativo').classList.remove('hidden');
                document.getElementById('comparativo-content').classList.add('hidden');
                document.getElementById('no-data-tabelas').classList.remove('hidden');
                document.getElementById('tabelas-content').classList.add('hidden');
            } else {
                // Nenhum arquivo foi importado
                hideProgress();
                
                // Mostrar alertas em todas as seções
                document.getElementById('no-data-alert').classList.remove('hidden');
                document.getElementById('dashboard-content').classList.add('hidden');
                document.getElementById('no-data-nacional').classList.remove('hidden');
                document.getElementById('nacional-content').classList.add('hidden');
                document.getElementById('no-data-regional').classList.remove('hidden');
                document.getElementById('regional-content').classList.add('hidden');
                document.getElementById('no-data-municipios').classList.remove('hidden');
                document.getElementById('municipios-content').classList.add('hidden');
                document.getElementById('no-data-mapa').classList.remove('hidden');
                document.getElementById('mapa-content').classList.add('hidden');
                document.getElementById('no-data-comparativo').classList.remove('hidden');
                document.getElementById('comparativo-content').classList.add('hidden');
                document.getElementById('no-data-tabelas').classList.remove('hidden');
                document.getElementById('tabelas-content').classList.add('hidden');
            }
        }

        // Atualizar dashboard principal
        function updateDashboard() {
            // Esconder alerta e mostrar conteúdo
            document.getElementById('no-data-alert').classList.add('hidden');
            document.getElementById('dashboard-content').classList.remove('hidden');
            
            // Atualizar estatísticas principais
            updateMainStats();
            
            // Atualizar gráficos
            updateCharts();
            
            // Atualizar tabela de municípios
            updateTopMunicipiosTable();
            
            // Atualizar todas as seções
            document.getElementById('no-data-nacional').classList.add('hidden');
            document.getElementById('nacional-content').classList.remove('hidden');
            document.getElementById('no-data-regional').classList.add('hidden');
            document.getElementById('regional-content').classList.remove('hidden');
            document.getElementById('no-data-municipios').classList.add('hidden');
            document.getElementById('municipios-content').classList.remove('hidden');
            document.getElementById('no-data-mapa').classList.add('hidden');
            document.getElementById('mapa-content').classList.remove('hidden');
            document.getElementById('no-data-comparativo').classList.add('hidden');
            document.getElementById('comparativo-content').classList.remove('hidden');
            document.getElementById('no-data-tabelas').classList.add('hidden');
            document.getElementById('tabelas-content').classList.remove('hidden');
            
            updateNacionalDashboard();
            updateRegionalDashboard();
            updateMunicipiosDashboard();
            updateTabelasDashboard();
        }

        // Atualizar estatísticas principais
        function updateMainStats() {
            // Dados do Brasil
            const dadosBrasil = appState.dadosBrNe.brasil;
            const ultimoAnoBrasil = dadosBrasil[dadosBrasil.length - 1];
            const penultimoAnoBrasil = dadosBrasil[dadosBrasil.length - 2];
            
            // Dados do Nordeste
            const dadosNordeste = appState.dadosBrNe.nordeste;
            const ultimoAnoNordeste = dadosNordeste[dadosNordeste.length - 1];
            const penultimoAnoNordeste = dadosNordeste[dadosNordeste.length - 2];
            
            // Taxa Nacional
            document.getElementById('taxa-nacional').textContent = ultimoAnoBrasil.taxaSubregistro.toFixed(2) + '%';
            
            // Tendência Nacional
            const diferencaTaxaNacional = ultimoAnoBrasil.taxaSubregistro - penultimoAnoBrasil.taxaSubregistro;
            const trendNacional = document.getElementById('trend-nacional');
            if (diferencaTaxaNacional < 0) {
                trendNacional.classList.add('down');
                trendNacional.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="18 15 12 9 6 15"></polyline>
                    </svg>
                    <span>${Math.abs(diferencaTaxaNacional).toFixed(2)}% em relação ao período anterior</span>
                `;
            } else {
                trendNacional.classList.add('up');
                trendNacional.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                    <span>${diferencaTaxaNacional.toFixed(2)}% em relação ao período anterior</span>
                `;
            }
            
            // Taxa Nordeste
            document.getElementById('taxa-nordeste').textContent = ultimoAnoNordeste.taxaSubregistro.toFixed(2) + '%';
            
            // Tendência Nordeste
            const diferencaTaxaNordeste = ultimoAnoNordeste.taxaSubregistro - penultimoAnoNordeste.taxaSubregistro;
            const trendNordeste = document.getElementById('trend-nordeste');
            if (diferencaTaxaNordeste < 0) {
                trendNordeste.classList.add('down');
                trendNordeste.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="18 15 12 9 6 15"></polyline>
                    </svg>
                    <span>${Math.abs(diferencaTaxaNordeste).toFixed(2)}% em relação ao período anterior</span>
                `;
            } else {
                trendNordeste.classList.add('up');
                trendNordeste.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                    <span>${diferencaTaxaNordeste.toFixed(2)}% em relação ao período anterior</span>
                `;
            }
            
            // Total de Nascimentos
            document.getElementById('total-nascimentos').textContent = ultimoAnoBrasil.nascidosVivos.toLocaleString('pt-BR');
            
            // Tendência Nascimentos
            const diferencaNascimentos = ultimoAnoBrasil.nascidosVivos - penultimoAnoBrasil.nascidosVivos;
            const percentualDiferencaNascimentos = (diferencaNascimentos / penultimoAnoBrasil.nascidosVivos) * 100;
            const trendNascimentos = document.getElementById('trend-nascimentos');
            if (diferencaNascimentos < 0) {
                trendNascimentos.classList.add('down');
                trendNascimentos.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                    <span>${Math.abs(percentualDiferencaNascimentos).toFixed(2)}% em relação ao período anterior</span>
                `;
            } else {
                trendNascimentos.classList.add('up');
                trendNascimentos.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="18 15 12 9 6 15"></polyline>
                    </svg>
                    <span>${percentualDiferencaNascimentos.toFixed(2)}% em relação ao período anterior</span>
                `;
            }
            
            // Total de Municípios
            document.getElementById('total-municipios').textContent = appState.dadosMunicipios.length.toLocaleString('pt-BR');
        }

        // Atualizar gráficos principais
        function updateCharts() {
            // Gráfico de evolução da taxa de subregistro
            const chartEvolucao = document.getElementById('chart-evolucao').getContext('2d');
            
            // Dados para o gráfico
            const dadosBrasil = appState.dadosBrNe.brasil;
            const dadosNordeste = appState.dadosBrNe.nordeste;
            
            const anos = dadosBrasil.map(item => item.ano);
            const taxasBrasil = dadosBrasil.map(item => item.taxaSubregistro);
            const taxasNordeste = dadosNordeste.map(item => item.taxaSubregistro);
            
            // Criar ou atualizar gráfico
            if (appState.chartsInstances.evolucao) {
                appState.chartsInstances.evolucao.destroy();
            }
            
            appState.chartsInstances.evolucao = new Chart(chartEvolucao, {
                type: 'line',
                data: {
                    labels: anos,
                    datasets: [
                        {
                            label: 'Brasil',
                            data: taxasBrasil,
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            tension: 0.3,
                            borderWidth: 2
                        },
                        {
                            label: 'Nordeste',
                            data: taxasNordeste,
                            borderColor: 'rgb(255, 99, 132)',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            tension: 0.3,
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        },
                        legend: {
                            position: 'top'
                        },
                        title: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Taxa de Subregistro (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Ano'
                            }
                        }
                    }
                }
            });
            
            // Gráfico de comparação por UF
            const chartUf = document.getElementById('chart-uf').getContext('2d');
            
            // Agrupar dados por UF
            const dadosPorUf = {};
            appState.dadosMunicipios.forEach(item => {
                if (!dadosPorUf[item.uf]) {
                    dadosPorUf[item.uf] = {
                        nascidosVivos: 0,
                        registrados: 0,
                        naoRegistrados: 0
                    };
                }
                
                dadosPorUf[item.uf].nascidosVivos += item.nascidosVivos;
                dadosPorUf[item.uf].registrados += item.registrados;
                dadosPorUf[item.uf].naoRegistrados += item.naoRegistrados;
            });
            
            // Calcular taxa de subregistro por UF
            const ufs = Object.keys(dadosPorUf);
            const taxasPorUf = ufs.map(uf => {
                const dados = dadosPorUf[uf];
                return (dados.naoRegistrados / dados.nascidosVivos) * 100;
            });
            
            // Ordenar UFs por taxa de subregistro
            const ufsSorted = ufs.map((uf, index) => ({
                uf,
                taxa: taxasPorUf[index]
            })).sort((a, b) => b.taxa - a.taxa);
            
            // Criar ou atualizar gráfico
            if (appState.chartsInstances.uf) {
                appState.chartsInstances.uf.destroy();
            }
            
            appState.chartsInstances.uf = new Chart(chartUf, {
                type: 'bar',
                data: {
                    labels: ufsSorted.map(item => item.uf),
                    datasets: [
                        {
                            label: 'Taxa de Subregistro (%)',
                            data: ufsSorted.map(item => item.taxa),
                            backgroundColor: ufsSorted.map(item => {
                                if (item.taxa > 20) return 'rgba(255, 99, 132, 0.7)';
                                if (item.taxa > 10) return 'rgba(255, 205, 86, 0.7)';
                                if (item.taxa > 5) return 'rgba(75, 192, 192, 0.7)';
                                return 'rgba(54, 162, 235, 0.7)';
                            }),
                            borderColor: ufsSorted.map(item => {
                                if (item.taxa > 20) return 'rgb(255, 99, 132)';
                                if (item.taxa > 10) return 'rgb(255, 205, 86)';
                                if (item.taxa > 5) return 'rgb(75, 192, 192)';
                                return 'rgb(54, 162, 235)';
                            }),
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const uf = context.label;
                                    const taxa = context.raw.toFixed(2) + '%';
                                    const nascidosVivos = dadosPorUf[uf].nascidosVivos.toLocaleString('pt-BR');
                                    const naoRegistrados = dadosPorUf[uf].naoRegistrados.toLocaleString('pt-BR');
                                    
                                    return [
                                        `Taxa: ${taxa}`,
                                        `Nascidos Vivos: ${nascidosVivos}`,
                                        `Não Registrados: ${naoRegistrados}`
                                    ];
                                }
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Taxa de Subregistro (%)'
                            }
                        }
                    }
                }
            });
            
            // Preencher select de anos
            const selectYear = document.getElementById('select-year');
            selectYear.innerHTML = '<option value="latest">Último período disponível</option>';
            
            anos.forEach(ano => {
                const option = document.createElement('option');
                option.value = ano;
                option.textContent = ano;
                selectYear.appendChild(option);
            });
        }

        // Atualizar tabela de municípios com maior subregistro
        function updateTopMunicipiosTable() {
            // Ordenar municípios por taxa de subregistro
            const municipiosOrdenados = [...appState.dadosMunicipios]
                .sort((a, b) => b.taxaSubregistro - a.taxaSubregistro)
                .slice(0, 10);
            
            // Preencher tabela
            const tabela = document.getElementById('table-top-municipios');
            const tbody = tabela.querySelector('tbody');
            tbody.innerHTML = '';
            
            municipiosOrdenados.forEach(municipio => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${municipio.municipio}</td>
                    <td>${municipio.uf}</td>
                    <td>${municipio.taxaSubregistro.toFixed(2)}%</td>
                    <td>${municipio.nascidosVivos.toLocaleString('pt-BR')}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Atualizar dashboard nacional
        function updateNacionalDashboard() {
            // Gráfico de evolução nacional
            const chartNacional = document.getElementById('chart-nacional').getContext('2d');
            
            // Dados para o gráfico
            const dadosBrasil = appState.dadosBrNe.brasil;
            
            const anos = dadosBrasil.map(item => item.ano);
            const taxas = dadosBrasil.map(item => item.taxaSubregistro);
            const nascidosVivos = dadosBrasil.map(item => item.nascidosVivos);
            
            // Criar ou atualizar gráfico
            if (appState.chartsInstances.nacional) {
                appState.chartsInstances.nacional.destroy();
            }
            
            appState.chartsInstances.nacional = new Chart(chartNacional, {
                type: 'line',
                data: {
                    labels: anos,
                    datasets: [
                        {
                            label: 'Taxa de Subregistro (%)',
                            data: taxas,
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            tension: 0.3,
                            borderWidth: 2,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Nascidos Vivos',
                            data: nascidosVivos,
                            borderColor: 'rgb(153, 102, 255)',
                            backgroundColor: 'rgba(153, 102, 255, 0.2)',
                            tension: 0.3,
                            borderWidth: 2,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Taxa de Subregistro (%)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Nascidos Vivos'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
            
            // Preencher tabela nacional
            const tabelaNacional = document.getElementById('table-nacional');
            const tbodyNacional = tabelaNacional.querySelector('tbody');
            tbodyNacional.innerHTML = '';
            
            dadosBrasil.forEach(item => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${item.ano}</td>
                    <td>${item.nascidosVivos.toLocaleString('pt-BR')}</td>
                    <td>${item.registrados.toLocaleString('pt-BR')}</td>
                    <td>${item.naoRegistrados.toLocaleString('pt-BR')}</td>
                    <td>${item.taxaSubregistro.toFixed(2)}%</td>
                `;
                tbodyNacional.appendChild(tr);
            });
            
            // Gráfico comparativo nacional
            const chartComparativoNacional = document.getElementById('chart-comparativo-nacional').getContext('2d');
            
            // Dados para o gráfico
            const ultimoAno = dadosBrasil[dadosBrasil.length - 1];
            
            // Criar ou atualizar gráfico
            if (appState.chartsInstances.comparativoNacional) {
                appState.chartsInstances.comparativoNacional.destroy();
            }
            
            appState.chartsInstances.comparativoNacional = new Chart(chartComparativoNacional, {
                type: 'pie',
                data: {
                    labels: ['Registrados', 'Não Registrados'],
                    datasets: [
                        {
                            data: [ultimoAno.registrados, ultimoAno.naoRegistrados],
                            backgroundColor: [
                                'rgba(75, 192, 192, 0.7)',
                                'rgba(255, 99, 132, 0.7)'
                            ],
                            borderColor: [
                                'rgb(75, 192, 192)',
                                'rgb(255, 99, 132)'
                            ],
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label;
                                    const value = context.raw.toLocaleString('pt-BR');
                                    const percentage = ((context.raw / ultimoAno.nascidosVivos) * 100).toFixed(2) + '%';
                                    return `${label}: ${value} (${percentage})`;
                                }
                            }
                        },
                        legend: {
                            position: 'top'
                        },
                        title: {
                            display: true,
                            text: `Distribuição de Registros - ${ultimoAno.ano}`
                        }
                    }
                }
            });
        }

        // Atualizar dashboard regional
        function updateRegionalDashboard() {
            // Gráfico de evolução regional
            const chartNordeste = document.getElementById('chart-nordeste').getContext('2d');
            
            // Dados para o gráfico
            const dadosNordeste = appState.dadosBrNe.nordeste;
            
            const anos = dadosNordeste.map(item => item.ano);
            const taxas = dadosNordeste.map(item => item.taxaSubregistro);
            const nascidosVivos = dadosNordeste.map(item => item.nascidosVivos);
            
            // Criar ou atualizar gráfico
            if (appState.chartsInstances.nordeste) {
                appState.chartsInstances.nordeste.destroy();
            }
            
            appState.chartsInstances.nordeste = new Chart(chartNordeste, {
                type: 'line',
                data: {
                    labels: anos,
                    datasets: [
                        {
                            label: 'Taxa de Subregistro (%)',
                            data: taxas,
                            borderColor: 'rgb(255, 99, 132)',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            tension: 0.3,
                            borderWidth: 2,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Nascidos Vivos',
                            data: nascidosVivos,
                            borderColor: 'rgb(153, 102, 255)',
                            backgroundColor: 'rgba(153, 102, 255, 0.2)',
                            tension: 0.3,
                            borderWidth: 2,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Taxa de Subregistro (%)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Nascidos Vivos'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
            
            // Gráfico por estados do NE
            const chartEstadosNE = document.getElementById('chart-estados-ne').getContext('2d');
            
            // Filtrar municípios do Nordeste
            const municipiosNE = appState.dadosMunicipios.filter(m => appState.ufNordeste.includes(m.uf));
            
            // Agrupar dados por UF
            const dadosPorUfNE = {};
            municipiosNE.forEach(item => {
                if (!dadosPorUfNE[item.uf]) {
                    dadosPorUfNE[item.uf] = {
                        nascidosVivos: 0,
                        registrados: 0,
                        naoRegistrados: 0
                    };
                }
                
                dadosPorUfNE[item.uf].nascidosVivos += item.nascidosVivos;
                dadosPorUfNE[item.uf].registrados += item.registrados;
                dadosPorUfNE[item.uf].naoRegistrados += item.naoRegistrados;
            });
            
            // Calcular taxa de subregistro por UF
            const ufsNE = appState.ufNordeste;
            const taxasPorUfNE = ufsNE.map(uf => {
                const dados = dadosPorUfNE[uf] || { nascidosVivos: 0, naoRegistrados: 0 };
                return dados.nascidosVivos > 0 ? (dados.naoRegistrados / dados.nascidosVivos) * 100 : 0;
            });
            
            // Criar ou atualizar gráfico
            if (appState.chartsInstances.estadosNE) {
                appState.chartsInstances.estadosNE.destroy();
            }
            
            appState.chartsInstances.estadosNE = new Chart(chartEstadosNE, {
                type: 'bar',
                data: {
                    labels: ufsNE,
                    datasets: [
                        {
                            label: 'Taxa de Subregistro (%)',
                            data: taxasPorUfNE,
                            backgroundColor: taxasPorUfNE.map(taxa => {
                                if (taxa > 20) return 'rgba(255, 99, 132, 0.7)';
                                if (taxa > 10) return 'rgba(255, 205, 86, 0.7)';
                                if (taxa > 5) return 'rgba(75, 192, 192, 0.7)';
                                return 'rgba(54, 162, 235, 0.7)';
                            }),
                            borderColor: taxasPorUfNE.map(taxa => {
                                if (taxa > 20) return 'rgb(255, 99, 132)';
                                if (taxa > 10) return 'rgb(255, 205, 86)';
                                if (taxa > 5) return 'rgb(75, 192, 192)';
                                return 'rgb(54, 162, 235)';
                            }),
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const uf = context.label;
                                    const taxa = context.raw.toFixed(2) + '%';
                                    const dados = dadosPorUfNE[uf] || { nascidosVivos: 0, registrados: 0, naoRegistrados: 0 };
